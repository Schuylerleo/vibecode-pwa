<!DOCTYPE html>
<html>
<head>
  <title>VibeCode PWA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100vh;overflow:hidden}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#111;color:#fff;display:flex;flex-direction:column}
    
    /* Header with spinner */
    #header{padding:15px 20px;background:rgba(0,102,255,0.1);border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center}
    #status{padding:8px 12px;background:#0066ff;border-radius:20px;font-size:14px;display:flex;align-items:center;gap:8px}
    .spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:#fff;animation:spin 1s linear infinite}
    .error{width:16px;height:16px;background:#ff4444;border-radius:50%;animation:pulse 1s infinite}
    #tokens{font-size:12px;background:rgba(0,0,0,0.7);padding:6px 12px;border-radius:20px}
    
    /* Chat area */
    #chat{flex:1;overflow-y:auto;padding:20px;padding-bottom:20px}
    .msg{padding:14px 18px;margin:10px 0;border-radius:18px;max-width:90%;word-wrap:break-word;box-shadow:0 2px 10px rgba(0,0,0,0.3)}
    .user{background:#0066ff;margin-left:auto;max-width:80%;text-align:right}
    .ai{background:#2a2a2a;max-width:85%}
    
    /* Input + Buttons - FIXED LAYOUT */
    #bottom{display:flex;flex-direction:column;gap:12px;padding:0 20px 20px;background:#111}
    #input{display:flex;gap:10px}
    #msg{flex:1;padding:14px;border:2px solid #444;border-radius:25px;background:#222;color:#fff;font-size:16px;outline:none}
    #msg:focus{border-color:#0066ff;box-shadow:0 0 0 3px rgba(0,102,255,0.2)}
    
    /* Buttons BELOW input */
    .buttons{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
    button{padding:12px 16px;border:none;border-radius:20px;background:#0066ff;color:white;cursor:pointer;font-size:14px;font-weight:500;transition:all 0.2s;box-shadow:0 2px 8px rgba(0,102,255,0.3)}
    button:hover{background:#0052cc;transform:translateY(-1px)}
    button:active{transform:translateY(0)}
    
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
  </style>
</head>
<body>
  <!-- Header with status -->
  <div id="header">
    <div id="status"><span class="spinner"></span> VibeCode READY</div>
    <div id="tokens">Tokens: <span id="count">0</span></div>
  </div>
  
  <!-- Chat messages -->
  <div id="chat">
    <div class="msg ai">üöÄ Welcome to VibeCode PWA!<br><br>üí° Try these:<br>‚Ä¢ "make glow navbar"<br>‚Ä¢ "idea login page"<br>‚Ä¢ "/help offline sync"</div>
  </div>
  
  <!-- Input + Buttons BELOW chat -->
  <div id="bottom">
    <div id="input">
      <input id="msg" placeholder="Type your idea... (glow navbar, todo app, etc)">
      <button onclick="sendMsg()">Send</button>
    </div>
    <div class="buttons">
      <button onclick="newChat()">üÜï New Chat</button>
      <button onclick="showPEBot()">üéØ Prompt Bot</button>
      <button onclick="showHelper()">üí° Helper</button>
      <button onclick="previewLast()">üëÅÔ∏è Preview</button>
    </div>
  </div>

  <script>
    let messages = [], tokens = 0, currentBot = 'main', isProcessing = false;
    
    function addMsg(text, role = 'ai', status = 'normal') {
      const chat = document.getElementById('chat');
      const div = document.createElement('div');
      div.className = `msg ${role}`;
      
      if (status === 'loading') {
        div.innerHTML = `<span class="spinner"></span> <strong>${text}</strong>`;
      } else if (status === 'error') {
        div.innerHTML = `<span class="error"></span> ${text}`;
      } else {
        div.textContent = text;
      }
      
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
      
      if (role === 'ai' && status !== 'loading') {
        document.getElementById('count').textContent = tokens += 75;
      }
    }
    
    function detectBot(text) {
      if (text.startsWith('/help')) return 'helper';
      if (text.includes('idea') || text.length < 40) return 'pe';
      return 'main';
    }
    
    function sendMsg() {
      if (isProcessing) return;
      
      const input = document.getElementById('msg');
      const text = input.value.trim();
      if (!text) return;
      
      addMsg(text, 'user');
      input.value = '';
      currentBot = detectBot(text);
      
      // Show processing
      isProcessing = true;
      addMsg(`${currentBot.toUpperCase()} thinking...`, 'ai', 'loading');
      
      setTimeout(() => {
        // Remove loading message
        document.querySelector('.msg:last-child').remove();
        
        let response = '';
        if (currentBot === 'pe') {
          response = `üéØ PERFECT PROMPT:

"Create responsive ${text} with modern CSS, mobile-first design, dark theme, smooth animations, PWA features"

‚ú® Next: Click "Send" with "make ${text}"`;
        } else if (currentBot === 'helper') {
          response = `üí° TIPS for "${text}":
‚Ä¢ Use CSS Grid + Flexbox
‚Ä¢ Add service worker
‚Ä¢ Mobile-first design
‚Ä¢ localStorage data
‚Ä¢ Transform animations`;
        } else {
          response = `‚ú® CODE GENERATED:

```html
<!DOCTYPE html>
<html>
<head>
<title>${text}</title>
<meta name="viewport" content="width=device-width">
<style>*{margin:0;padding:0;box-sizing:border-box}body{background:linear-gradient(45deg,#111,#0066ff);min-height:100vh;padding:20px;color:white;font-family:sans-serif;display:flex;align-items:center;justify-content:center}h1{font-size:clamp(2rem,10vw,4rem);text-shadow:0 0 30px #0066ff;animation:glow 2s infinite}@keyframes glow{0%,100%{opacity:1}50%{opacity:0.7}}</style></head>
<body><h1>${text}</h1><p>‚úÖ VibeCode Generated!</p></body>
</html>
```

üíæ Save as index.html ‚Üí Acode ready!`;
        }
        
        addMsg(response);
        isProcessing = false;
      }, 1500 + Math.random() * 1000);
    }
    
    function newChat() {
      messages = []; tokens = 0;
      document.getElementById('chat').innerHTML = '<div class="msg ai">üöÄ New chat started! Try "make glow navbar"</div>';
      document.getElementById('count').textContent = '0';
      document.getElementById('msg').focus();
    }
    
    function showPEBot() { currentBot = 'pe'; addMsg('üéØ Prompt Expert Bot activated!', 'ai'); }
    function showHelper() { currentBot = 'helper'; addMsg('üí° Helper Bot activated!', 'ai'); }
    function previewLast() { addMsg('üëÅÔ∏è Preview: Copy last code block to new index.html', 'ai'); }
    
    // Enter key + focus
    document.getElementById('msg').addEventListener('keypress', e => {
      if (e.key === 'Enter' && !isProcessing) sendMsg();
    });
    document.getElementById('msg').focus();
  </script>
</body>
</html>
