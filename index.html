<!DOCTYPE html>
<html>
<head>
  <title>VibeCode PWA - Real AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:sans-serif;background:#111;color:#fff;height:100vh;display:flex;flex-direction:column}
    
    #header{padding:15px 20px;background:#222;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #444}
    #status{padding:10px;background:#00ff88;border-radius:20px;font-size:14px;font-weight:bold}
    .spinner{display:inline-block;width:16px;height:16px;border:2px solid #fff3;border-radius:50%;border-top-color:#00ff88;animation:spin 1s linear infinite}
    #tokens{background:#0066ff;padding:10px 15px;border-radius:25px;font-weight:bold;cursor:pointer}
    
    #chat{flex:1;overflow-y:auto;padding:20px}
    .msg{padding:15px;margin:10px 0;border-radius:20px;max-width:90%;background:#333;white-space:pre-wrap}
    .user{background:#0066ff;margin-left:auto}
    
    #bottom{padding:25px;background:#111;display:flex;flex-direction:column;gap:15px}
    #input{display:flex;gap:10px}
    #msg{flex:1;padding:15px;border:2px solid #555;border-radius:25px;background:#222;color:#fff;font-size:16px}
    #msg:focus{border-color:#0066ff;outline:none}
    
    button{padding:15px;flex:1;border:none;border-radius:25px;background:#0066ff;color:white;font-size:16px;font-weight:bold;cursor:pointer}
    .buttons{display:flex;gap:10px}
    
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div id="header">
    <div id="status"><span class="spinner"></span> <span id="ai-status">Gemini AI</span></div>
    <div id="tokens" onclick="toggleAPI()">Tokens: <span id="count">0</span></div>
  </div>
  
  <div id="chat">
    <div class="msg">üöÄ PHASE 2: Real Gemini AI ACTIVE!<br>‚úÖ Say "make login page" ‚Üí Get REAL AI code</div>
  </div>
  
  <div id="bottom">
    <div id="input">
      <input id="msg" placeholder="make animated login page...">
      <button onclick="sendMsg()">Send</button>
    </div>
    <div class="buttons">
      <button onclick="newChat()">üÜï New</button>
      <button onclick="exportCode()">üíæ Export</button>
    </div>
  </div>

  <script>
    // PHASE 2: Replace AIzaSyAyNdp8F2LRpmbSH7J-yvR_lixKH68TlMg with real key
    const GEMINI_API_KEY = 'AIzaSyAyNdp8F2LRpmbSH7J-yvR_lixKH68TlMg'; // Paste from Step 1
    let tokens = 0, isRealAI = GEMINI_API_KEY !== 'YOUR_API_KEY_HERE';
    
    function addMsg(text, isUser = false) {
      const chat = document.getElementById('chat');
      const msg = document.createElement('div');
      msg.className = `msg ${isUser ? 'user' : ''}`;
      msg.textContent = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
      if (!isUser) {
        tokens += 150;
        document.getElementById('count').textContent = tokens;
      }
    }
    
    async function sendMsg() {
      const input = document.getElementById('msg');
      const text = input.value.trim();
      if (!text) return;
      
      input.value = '';
      addMsg(text, true);
      addMsg('ü§ñ ' + (isRealAI ? 'Gemini AI' : 'Demo') + ' generating...');
      
      if (isRealAI) {
        try {
          // REAL GEMINI API CALL
          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${GEMINI_API_KEY}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: `Generate COMPLETE working HTML/CSS/JS PWA code for: "${text}". Make it mobile-first, dark theme, modern animations, fully responsive. Return ONLY the code (no explanations). Start with <!DOCTYPE html>`
                }]
              }]
            })
          });
          
          const data = await response.json();
          const aiCode = data.candidates[0].content.parts[0].text;
          
          document.querySelector('.msg:last-child').remove();
          addMsg('‚ú® GEMINI AI GENERATED:

```html
' + aiCode + '
```

üíæ Copy ‚Üí Save ‚Üí Acode!');
          
        } catch (error) {
          document.querySelector('.msg:last-child').remove();
          addMsg('‚ùå API Error - Using demo mode

```html
<!DOCTYPE html>
<html><head><title>' + text + '</title><style>*{margin:0;padding:0;box-sizing:border-box}body{background:linear-gradient(45deg,#111,#0066ff);min-height:100vh;padding:20px;color:#fff;font-family:sans-serif;display:flex;align-items:center;justify-content:center}h1{font-size:clamp(2rem,10vw,4rem);text-shadow:0 0 30px #0066ff}</style></head><body><h1>' + text + '</h1></body></html>
```');
        }
      } else {
        // DEMO MODE
        setTimeout(() => {
          document.querySelector('.msg:last-child').remove();
          addMsg('‚ú® DEMO MODE:

```html
<!DOCTYPE html>
<html>
<head>
<title>' + text + '</title>
<meta name="viewport" content="width=device-width">
<style>*{margin:0;padding:0;box-sizing:border-box}body{background:linear-gradient(45deg,#111,#0066ff);min-height:100vh;padding:20px;color:#fff;font-family:sans-serif;display:flex;align-items:center;justify-content:center;flex-direction:column}h1{font-size:clamp(2rem,10vw,4rem);text-shadow:0 0 30px #0066ff;animation:glow 2s infinite}@keyframes glow{0%,100%{opacity:1}50%{opacity:0.8}}</style>
</head>
<body>
<h1>' + text + '</h1>
<p>‚úÖ VibeCode PWA Generated!</p>
</body>
</html>
```

üîë Get Gemini API key to enable real AI!');
        }, 1200);
      }
    }
    
    function newChat() {
      tokens = 0;
      document.getElementById('chat').innerHTML = '<div class="msg">üöÄ New chat - Real AI ready!</div>';
      document.getElementById('count').textContent = '0';
      document.getElementById('ai-status').textContent = isRealAI ? 'Gemini AI LIVE' : 'Demo Mode';
    }
    
    function toggleAPI() {
      if (isRealAI) {
        addMsg('üîë Gemini API Active!
üìä Free tier: 15 req/min');
      } else {
        addMsg('üîë Get API key: aistudio.google.com/app/apikey
‚ú® Paste in code ‚Üí Real AI!');
      }
    }
    
    function exportCode() {
      const code = document.querySelector('.msg.ai:last-child');
      if (code) {
        navigator.clipboard.writeText(code.textContent).then(() => {
          addMsg('‚úÖ Code copied to clipboard!');
        });
      }
    }
    
    document.getElementById('msg').addEventListener('keypress', e => {
      if (e.key === 'Enter') sendMsg();
    });
    
    document.getElementById('msg').focus();
    newChat();
  </script>
</body>
</html>